<%# locals: (form:, disabled: false, required: false, name:, label: nil, id:, value: nil, url: nil, frame: nil, source_override: nil, options: [], confirmable: false, query_string: nil, modal_name: nil, modal_url: nil, chip_css: nil, fixed: false) %>
<div class="mdc-select mdc-select--filled w-full"
     data-controller="material-chips-select"
     data-material-chips-select-selected-value="<%= value %>"
     data-material-chips-select-url-value="<%= url %>"
     data-material-chips-select-confirmable-value="<%= confirmable %>"
     data-material-chips-select-query-string-value="<%= query_string %>"
     data-material-chips-select-modal-name-value="<%= modal_name %>"
     data-material-chips-select-modal-url-value="<%= modal_url %>"
     data-material-chips-select-chip-css-value="<%= chip_css %>"
>
  <div class="mdc-select__anchor !h-fit !flex-row !flex-wrap"
       role="button"
       aria-haspopup="listbox"
       aria-expanded="false"
       aria-expanded="false"
       aria-labelledby="<%= id %>-label <%= id %>-selected-text"
       <% if disabled %>aria-disabled="true"<% end %>
       <% if required %>aria-required="true"<% end %>
  >
    <span class="mdc-select__ripple"></span>
    <span id="<%= id %>-label" class="mdc-floating-label !relative !w-full"><%= label || name.capitalize %></span>
    <div class="mdc-chip-set !grow !flex-wrap" role="grid"></div>
    <%= render 'components/select_dropdown_icon' %>
    <span class="mdc-select__selected-text-container !grow-0 !max-h-0"><span id="<%= id %>-selected-text" class="mdc-select__selected-text !hidden"></span></span>
    <span class="mdc-line-ripple"></span>
  </div>
  <%= form.hidden_field name.to_sym, value: value, data: { 'material-chips-select-target': 'hidden' } if form %>
  <div class="mdc-select__menu mdc-menu mdc-menu-surface <%= fixed ? 'mdc-menu-surface--fixed' : 'mdc-menu-surface--fullwidth' %>">
    <ul class="mdc-deprecated-list" role="listbox" aria-label="<%= label %> listbox">
      <% options.each do |option| %>
        <li class="mdc-deprecated-list-item" aria-selected="false" data-value="<%= option[:value] %>" data-label="<%= option[:label] %>" <% if option[:confirmed].in? [true, false] %>data-confirmed="<%= option[:confirmed] %>"<% end %> role="option">
          <span class="mdc-deprecated-list-item__ripple"></span>
          <span class="mdc-deprecated-list-item__text"><%= option[:label] %></span>
        </li>
      <% end %>
    </ul>
  </div>
</div>
